<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>WebSocket Test - User 2</title>
</head>
<body>
<h1>User 2 WebSocket Test</h1>

<div>
    <input type="text" id="messageInput" placeholder="보낼 메시지를 입력하세요">
    <button onclick="sendMessage()">Send</button>
</div>

<div>
    <h3>Logs</h3>
    <pre id="logs"></pre>
</div>

<script>
    // User 2 JWT 토큰
    const token = "eyJhbGciOiJIUzUxMiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJtYXJrZXQtcGxhY2Utand0IiwiZXhwIjoxNzU2Nzc5NjA1LCJpZCI6MSwibG9naW5JZCI6ImFkbWluIiwicm9sZSI6IkFETUlOIn0.XoOiXObczP9J4AXB4ZACetEKGYbWmGfohj1aqSWaIkWSqOaHCbeL5xkKAT3e59eGaSXFTiS410s7NQCoeSFf7A";

    const socket = new WebSocket("ws://localhost:8080/ws-stomp?token=" + token);

    const logs = document.getElementById("logs");
    function log(msg) { logs.textContent += msg + "\n"; }

    socket.onopen = () => log("✅ Connected");
    socket.onmessage = (event) => log("📩 Received: " + event.data);
    socket.onclose = () => log("❌ Disconnected");
    socket.onerror = (error) => log("⚠️ Error: " + error);

    function sendMessage() {
        const input = document.getElementById("messageInput");
        const msg = input.value;
        socket.send(JSON.stringify({ message: msg, receiveId: 1 })); // 상대방 userId 1
        log("📤 Sent: " + msg);
        input.value = "";
    }
</script>
</body>
</html>
